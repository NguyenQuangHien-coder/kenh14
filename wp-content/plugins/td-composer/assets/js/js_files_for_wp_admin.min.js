var tdcWindowFrame;
(function(c,e){tdcWindowFrame={_isInitialized:!1,_arrCssSelectors:[],_inMoving:!1,_inResizing:!1,$_currentWindowFrame:e,$_tdcIframeCover:e,$_tdcSidebar:e,$_window:e,moveCssSelector:"",resizeCssSelector:"",_currentWindowPosition:e,_lastZIndex:1E3,_resizeOffset:e,_markerCssClass:"tdc-window-frame",init:function(a){if(!tdcWindowFrame._isInitialized){tdcWindowFrame._arrCssSelectors=a;tdcWindowFrame.$_window=c(window);tdcWindowFrame.$_tdcIframeCover=c("#tdc-iframe-cover");tdcWindowFrame.$_tdcSidebar=c("#tdc-sidebar");
for(var b=0;b<a.length;b++){var d=a[b]+" header.tdb-wm-header-drag",f=a[b]+" .tdw-resize";0!==b&&(d=","+d,f=","+f);tdcWindowFrame.moveCssSelector+=d;tdcWindowFrame.resizeCssSelector+=f;c(a[b]).on("mousedown",function(a){a=c(this);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)})}tdcWindowFrame.setEvents();tdcWindowFrame.$_window.on("resize",function(){c("."+tdcWindowFrame._markerCssClass).each(function(a,b){a=c(b);b={};var d=a.offset();d.left+100>tdcWindowFrame.$_window.width()&&(b.left=
tdcWindowFrame.$_window.width()-100);d.top+100>tdcWindowFrame.$_window.height()&&(b.top=tdcWindowFrame.$_window.height()-100);c.isEmptyObject(b)||a.css(b)});"undefined"!==typeof tdcContextMenu&&tdcContextMenu.hide()});tdcWindowFrame._isInitialized=!0}},moveCssSelectorMouseDownHandler:function(a){a.currentTarget===a.target&&(tdcWindowFrame.$_currentWindowFrame=c(a.currentTarget).parent(),tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame),tdcWindowFrame._inMoving=!0,tdcWindowFrame.setCurrentWindowFramePosition(a),
tdcWindowFrame.setMouseInitialPosition({left:a.pageX,top:a.pageY}),tdcWindowFrame._disableCurrentWindowContent())},moveCssSelectorMouseUpHandler:function(a){a.currentTarget===a.target&&(tdcWindowFrame._inMoving=!1,tdcWindowFrame.setCurrentWindowFramePosition(a),tdcWindowFrame.setMouseInitialPosition(e),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._enableCurrentWindowContent())},bodyMouseUpHandler:function(a){tdcWindowFrame._inMoving=!1;tdcWindowFrame._inResizing=!1;tdcWindowFrame.setCurrentWindowFramePosition(a);
tdcWindowFrame.setMouseInitialPosition({left:a.pageX,top:a.pageY});tdcWindowFrame._resizeOffset=e;tdcWindowFrame._disableBackground(!1)},bodyMouseMoveHandler:function(a){c(this);if(tdcWindowFrame._inMoving){a.stopPropagation();a.preventDefault();var b=tdcWindowFrame.getMouseInitialPosition();if("undefined"!==typeof b){var d=tdcWindowFrame.getCurrentWindowFramePosition();tdcWindowFrame.$_currentWindowFrame.css({left:a.pageX-(b.left-d.left),top:a.pageY-(b.top-d.top)});tdcWindowFrame.$_currentWindowFrame.addClass("clear-position");
tdcWindowFrame._disableBackground()}}else if(tdcWindowFrame._inResizing&&(a.stopPropagation(),a.preventDefault(),b=tdcWindowFrame.getMouseInitialPosition(),"undefined"!==typeof b)){var f={offsetLeft:0,offsetTop:0};_.isUndefined(tdcWindowFrame._resizeOffset)||(f=tdcWindowFrame._resizeOffset);d=tdcWindowFrame.getCurrentWindowFramePosition();b=a.pageX-d.left+f.width-f.offsetLeft;a=a.pageY-d.top+f.height-f.offsetTop;tdcWindowFrame.$_currentWindowFrame.css({width:b,height:a});tdcWindowFrame.$_currentWindowFrame.data("width",
b);tdcWindowFrame.$_currentWindowFrame.data("height",a);tdcWindowFrame._timerResize=setTimeout(function(){"undefined"!==typeof tdcWindowFrame._timerResize&&(clearTimeout(tdcWindowFrame._timerResize),editor.resize(!0))},100);tdcWindowFrame._disableBackground()}},resizeCssSelectorMouseDownHandler:function(a){if(a.currentTarget===a.target){var b=c(a.currentTarget);tdcWindowFrame.$_currentWindowFrame=c(a.currentTarget).closest("."+tdcWindowFrame._markerCssClass);tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame);
tdcWindowFrame._inResizing=!0;tdcWindowFrame.setCurrentWindowFramePosition(a);tdcWindowFrame.setMouseInitialPosition({left:a.pageX,top:a.pageY});tdcWindowFrame._resizeOffset={width:b.width(),height:b.height(),offsetLeft:a.pageX-b.offset().left,offsetTop:a.pageY-b.offset().top}}},resizeCssSelectorMouseUpHandler:function(a){a.currentTarget===a.target&&(tdcWindowFrame._inResizing=!1,tdcWindowFrame.setMouseInitialPosition(e),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._resizeOffset=e)},generalClickHandler:function(a){a.currentTarget===
a.target&&(a=c(a.currentTarget).closest(".tdc-window-frame"),"tdw-css-writer"!==a.attr("id")&&(a.removeClass("clear-position"),a.css({left:"",top:""})),tdcWindowFrame.unsetWindowFrame(a))},generalMouseDownHandler:function(a){a=c(a.currentTarget);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)},setEvents:function(){var a=c("body");a.unbind("mousedown",tdcWindowFrame.moveCssSelectorMouseDownHandler);a.on("mousedown",tdcWindowFrame.moveCssSelector,tdcWindowFrame.moveCssSelectorMouseDownHandler);
a.unbind("mouseup",tdcWindowFrame.moveCssSelectorMouseUpHandler);a.on("mouseup",tdcWindowFrame.moveCssSelector,tdcWindowFrame.moveCssSelectorMouseUpHandler);a.unbind("mouseup",tdcWindowFrame.bodyMouseUpHandler);a.on("mouseup",tdcWindowFrame.bodyMouseUpHandler);a.unbind("mousemove",tdcWindowFrame.bodyMouseMoveHandler);a.on("mousemove",tdcWindowFrame.bodyMouseMoveHandler);a.unbind("mousedown",tdcWindowFrame.resizeCssSelectorMouseDownHandler);a.on("mousedown",tdcWindowFrame.resizeCssSelector,tdcWindowFrame.resizeCssSelectorMouseDownHandler);
a.unbind("mouseup",tdcWindowFrame.resizeCssSelectorMouseUpHandler);a.on("mouseup",tdcWindowFrame.resizeCssSelector,tdcWindowFrame.resizeCssSelectorMouseUpHandler);a.unbind("click",tdcWindowFrame.generalClickHandler);a.on("click",".tdw-css-writer-expand .tdw-expand-collapse, .tdw-close, .tdc-iframe-close-button",tdcWindowFrame.generalClickHandler);a.unbind("mousedown",tdcWindowFrame.generalMouseDownHandler);a.on("mousedown",".tdc-window-frame",tdcWindowFrame.generalMouseDownHandler)},add:function(a){if(tdcWindowFrame._isInitialized){for(var b=
0;b<a.length;b++){var d=a[b]+" header.tdb-wm-header-drag",f=a[b]+" .tdw-resize";""!==tdcWindowFrame.moveCssSelector&&(d=","+d);tdcWindowFrame.moveCssSelector+=d;""!==tdcWindowFrame.resizeCssSelector&&(f=","+f);tdcWindowFrame.resizeCssSelector+=f;c(a[b]).on("mousedown",function(a){a=c(this);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)})}tdcWindowFrame.setEvents()}},getCurrentWindowFramePosition:function(){return tdcWindowFrame._currentWindowPosition},setCurrentWindowFramePosition:function(a){tdcWindowFrame._currentWindowPosition=
"undefined"===typeof tdcWindowFrame.$_currentWindowFrame?e:tdcWindowFrame.$_currentWindowFrame.offset()},setMouseInitialPosition:function(a){tdcWindowFrame._mouseInitialPosition=a},getMouseInitialPosition:function(){return tdcWindowFrame._mouseInitialPosition},_disableBackground:function(a){"undefined"!==typeof a&&!1===a?tdcWindowFrame.$_tdcIframeCover.removeClass("tdc-iframe-cover-transparent"):tdcWindowFrame.$_tdcIframeCover.addClass("tdc-iframe-cover-transparent")},_enableCurrentWindowContent:function(){"undefined"!==
typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events","")},_disableCurrentWindowContent:function(){"undefined"!==typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events","none")},setWindowFrame:function(a){c("."+tdcWindowFrame._markerCssClass).addClass("tdw-inactive");a.addClass(tdcWindowFrame._markerCssClass);tdcWindowFrame.$_tdcIframeCover.css({"z-index":++tdcWindowFrame._lastZIndex});
a.css({"z-index":++tdcWindowFrame._lastZIndex});a.removeClass("tdw-inactive")},unsetWindowFrame:function(a){a.removeClass(tdcWindowFrame._markerCssClass);setTimeout(function(){tdcWindowFrame.activeLastWindowFrame()},50)},activeLastWindowFrame:function(){var a=e,b=-1;c("."+tdcWindowFrame._markerCssClass).each(function(d,f){d=c(f);f=parseInt(d.css("z-index"));f>b&&(b=f,a=d)});"undefined"!==typeof a&&a.removeClass("tdw-inactive")},getMarkerCssClass:function(){return tdcWindowFrame._markerCssClass}};
c(window).on("load",function(){tdcWindowFrame.init(["#tdw-css-writer","#tdc-menu-settings","#tdc-page-settings","#tdc-wpeditor"])})})(jQuery);var tdcNotice;
(function(c,e){tdcNotice={$_noticeWrapper:e,_isInitialized:!1,_errorNotices:[],inError:!1,notice:function(a,b,c){var d={};_.isUndefined(b)||!0!==b||(d.type="error");_.isUndefined(c)||!0!==c||(d.hasClose=!0);tdcNotice.showNotice(a,d)},showNotice:function(a,b){if(tdcNotice._isInitialized){var d="",e="",k=!1,h=5E3;if("undefined"!==typeof b){if("undefined"!==typeof b.type)switch(b.type){case "error":d="tdc-notice-error";k=!0;break;case "info":d="tdc-notice-info"}"undefined"!==typeof b.hasClose&&!0===
b.hasClose&&(e='<div class="tdc-close-notice"></div>');"undefined"!==typeof b.timeout&&(h=b.timeout)}k&&(a+=" Current state has involved an issue. You could try an UNDO operation (CTRL+Z / CTRL+SHIFT+Z)");var g=c('<div class="tdc-notice '+d+'"><span class="tdc-msg-tag"></span>'+a+e+"</div>");tdcNotice.$_noticeWrapper.append(g);setTimeout(function(){g.addClass("tdc-notice-in")},100);if(k)throw tdcNotice._errorNotices.push(g),tdcNotice.inError=!0,tdcRecycle.init(),c("body").addClass("tdcComposerLoaded"),
a;setTimeout(function(){g.removeClass("tdc-notice-in")},h-1E3);setTimeout(function(){g.css("margin-top","-"+g.outerHeight()+"px")},h-500);setTimeout(function(){g.remove()},h)}},removeAll:function(){tdcNotice._errorNotices.forEach(function(a,b){a.remove()})},init:function(){tdcNotice._isInitialized||(tdcNotice.$_noticeWrapper=c('<div class="tdc-notice-wrapper"></div>'),tdcNotice.$_noticeWrapper.on("click",".tdc-close-notice",function(a){c(this).closest(".tdc-notice").remove()}),c("#tdc-live-iframe-wrapper").append(tdcNotice.$_noticeWrapper),
tdcNotice._isInitialized=!0)}};tdcNotice.init()})(jQuery);var tdcShortcodeParser={};
(function(){tdcShortcodeParser={levels:{},init:function(c){tdcShortcodeParser.levels=_.clone(c);tdcShortcodeParser.levels[3]=tdcShortcodeParser.levels[3].concat(tdcShortcodeParser.levels[5])},multiNext:function(c,e){c=tdcShortcodeParser.levels[c];for(var a,b=0;b<c.length;b++){var d=tdcShortcodeParser.generateTreeElement(wp.shortcode.next(c[b],e));"undefined"!==typeof d&&("undefined"===typeof a||a.index>d.index)&&(a=d)}return a},parse:function(c,e){for(var a=tdcShortcodeParser.multiNext(c,e),b=0,d=
[];"undefined"!==typeof a&&5E3>b;)e=e.substring(a.index+a.content.length),5>c&&(a.child=tdcShortcodeParser.parse(c+1,a.content)),d.push(a),a=tdcShortcodeParser.multiNext(c,e),b++;return d},generateTreeElement:function(c){return c}}})();var tdcInit={};
(function(c,e,a){tdcInit={$formPost:a,_title:"TagDiv Composer Draft",_url:"",$title:a,$titlePromptText:a,$contentWrap:a,$content:a,$contentIfr:a,$originalPostStatus:a,$_wpnonce:a,$postType:a,$postId:a,$postAuthor:a,$excerpt:a,$catslist:a,catslistValue:"",init:function(){tdcInit.$formPost=c("#post");if(tdcInit.$formPost.length){tdcInit.$title=tdcInit.$formPost.find("#title");tdcInit.$titlePromptText=tdcInit.$formPost.find("#title-prompt-text");tdcInit.$contentWrap=tdcInit.$formPost.find("#wp-content-wrap");
tdcInit.$content=tdcInit.$formPost.find("#content");tdcInit.$contentIfr=tdcInit.$formPost.find("#content_ifr");tdcInit.$originalPostStatus=tdcInit.$formPost.find("#original_post_status");tdcInit.$_wpnonce=tdcInit.$formPost.find("#_wpnonce");tdcInit.$postType=tdcInit.$formPost.find("#post_type");tdcInit.$postId=tdcInit.$formPost.find("#post_ID");tdcInit.$postAuthor=tdcInit.$formPost.find("#post_author");tdcInit.$excerpt=tdcInit.$formPost.find("#excerpt");tdcInit.$catslist=tdcInit.$formPost.find("input[type=checkbox][name^=post_category]");
e.each(tdcInit.$catslist,function(a,b,e){a=c(a);a.is(":checked")&&(tdcInit.catslistValue+=a.val()+",")});var a="page";tdcInit.$tdbTemplateType=tdcInit.$formPost.find("#tdb-template-type");tdcInit.$tdbTemplateType.length&&(a=tdcInit.$tdbTemplateType.val());tdcInit._url=window.tdcAdminSettings.adminUrl+"post.php?post_id="+tdcInit.$postId.val()+"&td_action=tdc&tdbTemplateType="+a;"footer"===a||"page"!==tdcInit.$postType.val()&&"tdb_templates"!==tdcInit.$postType.val()||!0!==window.tdcAdminSettings.hasUserRights||
window.tdcAdminSettings.isPageForPosts||c('<div class="tdc-panel-button"><div class="tdc-panel-icon"></div><div class="tdc-panel-link"><a onclick="return tdcInit.savePost( event )" href="'+tdcInit._url+'">TagDiv Composer</a></div></div>').insertAfter("div#titlediv")}},_checkPostContent:function(){tdcInit.$title.length&&tdcInit.$titlePromptText.length&&0===tdcInit.$title.val().trim().length&&(tdcInit.$title.val(tdcInit._title),tdcInit.$titlePromptText.hide());tdcShortcodeParser.init({0:["tdc_zone"],
1:["vc_row"],2:["vc_column"],3:["vc_row_inner"],4:["vc_column_inner"],5:[]});return tdcInit.$contentWrap.hasClass("tmce-active")?tinyMCE.activeEditor.getContent():tdcInit.$formPost.find("#content").val()},savePost:function(a){c(".tdc-panel-button").addClass("tdc-open-editor-loader");setTimeout(function(){c(".tdc-panel-button").removeClass("tdc-open-editor-loader")},2E3);a=tdcInit._checkPostContent();c.ajax({url:window.ajaxurl,type:"POST",data:{"data[wp_autosave][post_id]":tdcInit.$postId.val(),"data[wp_autosave][post_type]":tdcInit.$postType.val(),
"data[wp_autosave][post_author]":tdcInit.$postAuthor.val(),"data[wp_autosave][post_title]":tdcInit.$title.val(),"data[wp_autosave][content]":a,"data[wp_autosave][excerpt]":tdcInit.$excerpt.val(),"data[wp_autosave][catslist]":tdcInit.catslistValue,"data[wp_autosave][auto_draft]":1,"data[wp_autosave][_wpnonce]":tdcInit.$_wpnonce.val(),interval:60,_nonce:window.heartbeatSettings.nonce,action:"heartbeat",screen_id:tdcInit.$postType.val(),has_focus:!1}}).done(function(a,b,c){window.location=tdcInit._url});
return!1}};c(window).ready(function(){tdcInit.init()})})(jQuery,_);var tdcDebug;
(function(c,e){tdcDebug={_debug:!0,_logWindowObj:e,_content:e,_disabled:!1,log:function(a){tdcDebug._debug&&console.log(a)},dumpAllItems:function(){var a=tdcAdminIFrameUI.getIframeWindow();console.group("All items dump:");"undefined"!==typeof a.tdcComposerBlocksApi&&(console.log("%c tdcComposerBlocksApi.items ","background: #222; color: white"),console.log(a.tdcComposerBlocksApi.items));"undefined"!==typeof a.tdPullDown&&(console.log("%c tdPullDown.items ","background: #222; color: white"),console.log(a.tdPullDown.items));
"undefined"!==typeof a.tdAnimationSprite&&(console.log("%c tdAnimationSprite.items ","background: #222; color: white"),console.log(a.tdAnimationSprite.items));"undefined"!==typeof a.tdHomepageFull&&(console.log("%c tdHomepageFull.items ","background: #222; color: white"),console.log(a.tdHomepageFull.items));"undefined"!==typeof a.tdTrendingNow&&(console.log("%c tdTrendingNow.items ","background: #222; color: white"),console.log(a.tdTrendingNow.items));console.groupEnd()},group:function(a,b){!1!==
tdcDebug._debug&&(console.group?console.group(a,b):console.log(a))},groupCollapsed:function(a,b){!1!==tdcDebug._debug&&(console.groupCollapsed?console.groupCollapsed(a,b):console.log(a))},groupEnd:function(){!1!==tdcDebug._debug&&console.groupEnd&&console.groupEnd()},logWindow:function(a){if(e===tdcDebug._logWindowObj){tdcDebug._logWindowObj=c("<div></div>");var b=c('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Clear</div>'),d=c('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Disable</div>');
tdcDebug._content=c('<div style="clear: both"></div>');tdcDebug._logWindowObj.append(b);tdcDebug._logWindowObj.append(d);b.click(function(a){tdcDebug._content.html("")});d.click(function(a){tdcDebug._disabled=!tdcDebug._disabled;tdcDebug._disabled?c(this).css("background-color","#FF000"):c(this).css("background-color","")});tdcDebug._logWindowObj.append(tdcDebug._content);c("body").append(tdcDebug._logWindowObj);tdcDebug._logWindowObj.css({width:300,height:500,border:"1px solid red",position:"fixed",
bottom:0,right:20,"background-color":"#FFFFFF",overflow:"scroll","z-index":1E4})}tdcDebug._disabled||tdcDebug._content.html(a+"<br>"+tdcDebug._content.html())}}})(jQuery);
